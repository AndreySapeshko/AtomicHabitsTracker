# üì¶ CI/CD Pipeline ‚Äî –ü–æ–ª–Ω–æ–µ –û–ø–∏—Å–∞–Ω–∏–µ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏


–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CI/CD pipeline –Ω–∞ GitHub Actions 
—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π Docker-–æ–±—Ä–∞–∑–æ–≤ –≤ GitHub Container Registry (GHCR) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–µ–ø–ª–æ–µ–º –Ω–∞ production-—Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SSH.
---

## üöÄ –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞

`GitHub ‚Üí GitHub Actions ‚Üí GHCR ‚Üí Production Server (Docker Compose)
`
1. –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã:

2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (linting, —Ç–µ—Å—Ç—ã)

3. –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

4. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤

5. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤ –≤ GitHub Container Registry

6. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH

7. –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ docker-compose pull && docker-compose up -d

–≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π –¥–µ–ø–ª–æ–π.

---

## üîß –¢—Ä–∏–≥–≥–µ—Ä—ã CI/CD Workflow

Workflow –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –¥–≤—É—Ö —Å–ª—É—á–∞—è—Ö:
```
on:
  pull_request:
    branches: [develop]

  push:
    branches: [main]
```
‚úî PR ‚Üí develop

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ CI (–ø—Ä–æ–≤–µ—Ä–∫–∏, —Ç–µ—Å—Ç—ã, —Å–±–æ—Ä–∫–∏).

‚úî Push ‚Üí main

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π CI + CD, –≤–∫–ª—é—á–∞—è —Å–±–æ—Ä–∫—É
Docker-–æ–±—Ä–∞–∑–æ–≤ –∏ –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
---

## üß™ –≠—Ç–∞–ø—ã CI (Continuous Integration)

### 1. –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞ (Backend)

- black ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- flake8 ‚Äî –∞–Ω–∞–ª–∏–∑ —Å—Ç–∏–ª—è –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π Django

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ backend

–í CI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å:

`settings.ci ‚Äî SQLite + Celery eager + –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã–π Telegram Bot`


–ó–∞–¥–∞—á–∏:

- –ü—Ä–æ–≥–æ–Ω Django –º–∏–≥—Ä–∞—Ü–∏–π

- –ó–∞–ø—É—Å–∫ pytest

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ frontend

–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Vitest/Jest:
```
npm ci
npm run test -- --run
```
### 4. –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (Vite)

–ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã:

`npm run build`


–≠—Ç–æ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 
–ø—Ä–æ–¥–∞–∫—à–µ–Ω-–æ–±—Ä–∞–∑–µ frontend.
---

## üê≥ –≠—Ç–∞–ø—ã CD (Continuous Deployment)

### CD –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ push –≤ main.

### 5. Docker Build

GitHub Actions —Å–æ–±–∏—Ä–∞–µ—Ç –¥–≤–∞ production-–æ–±—Ä–∞–∑–∞:

- atomic-backend

- atomic-frontend

–ó–∞—Ç–µ–º –æ–±—Ä–∞–∑—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ GitHub Container Registry:

- ghcr.io/<owner>/atomic-backend:latest
- ghcr.io/<owner>/atomic-frontend:latest

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- –∏–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É (GHCR-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ)

- —Å–±–æ—Ä–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è

- —Å–µ—Ä–≤–µ—Ä –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã —Å–∞–º ‚Äî —Ç–æ–ª—å–∫–æ —Å–∫–∞—á–∏–≤–∞–µ—Ç

### 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä (SSH ‚Üí Docker Compose)

GitHub Actions –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ VPS —á–µ—Ä–µ–∑ SSH –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
```
cd /home/ubuntu/AtomicHabitsTracker
docker-compose pull
docker-compose up -d --build
```
–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –æ–±—Ä–∞–∑–æ–≤ –∏–∑ GHCR

- Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –æ–±—Ä–∞–∑—ã

- –¢–æ–º—ã, —Å–µ—Ç–∏, –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±—ã—Å—Ç—Ä—ã–π "rolling update" –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è

–†—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## üß† Key Benefits (—á—Ç–æ –¥–∞—ë—Ç —ç—Ç–∞ —Å–∏—Å—Ç–µ–º–∞):

### ‚úî –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Production

- –¥–µ–ø–ª–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ merge ‚Üí main

### ‚úî –†–µ–ø—Ä–æ–¥—É—Ü–∏—Ä—É–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

- —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ GitHub Actions, –∞ –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

### ‚úî Production –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ git-–∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

- –≤—Å—ë —Ç—è–Ω–µ—Ç—Å—è –∏–∑ GHCR.

### ‚úî –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å

- –≤—Å–µ —à–∞–≥–∏ CI/CD –≤–∏–¥–Ω–æ –≤ GitHub Actions UI.

### ‚úî –ù–∏–∫–∞–∫–∏—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–µ–ø–ª–æ–µ–≤

- —Ç–∞–∫ –∫–∞–∫ deploy-job –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ main.
---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ jobs (–Ω–∞–≥–ª—è–¥–Ω–æ)
```
PR ‚Üí develop
    ‚Üì
lint ‚Üí backend-tests ‚Üí frontend-tests ‚Üí frontend-build
    (stop)

Push ‚Üí main
    ‚Üì
lint ‚Üí backend-tests ‚Üí frontend-tests ‚Üí frontend-build
    ‚Üì
docker-build-and-push ‚Üí deploy-to-server
```
---

## üîê –°–µ–∫—Ä–µ—Ç—ã GitHub Actions

| Secret                | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
| --------------------- | ------------------------------------------------ |
| `PROD_SERVER_HOST`    | IP-–∞–¥—Ä–µ—Å production VPS                          |
| `PROD_SERVER_USER`    | –õ–æ–≥–∏–Ω (`ubuntu`, `root`, ...)                    |
| `PROD_SERVER_SSH_KEY` | –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH-–∫–ª—é—á                               |
| `GITHUB_TOKEN`        | —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—É—à–∏—Ç—å –≤ GHCR |

---

## üìò –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CI –ø—Ä–æ—Ñ–∏–ª—å Django (settings/ci.py)

–î–ª—è CI:

- SQLite –≤–º–µ—Å—Ç–æ PostgreSQL

- Celery –≤ —Ä–µ–∂–∏–º–µ always_eager

- –æ—Ç–∫–ª—é—á—ë–Ω Redis

- –æ—Ç–∫–ª—é—á—ë–Ω Telegram Bot

- —É–ø—Ä–æ—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –∏ 
—á–∏—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã.
---

## üéâ –ò—Ç–æ–≥

CI/CD –≤ –ø—Ä–æ–µ–∫—Ç–µ Atomic Habits Tracker –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ best-practices –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è:

- –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π production —á–µ—Ä–µ–∑ Docker

- —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –≤ GitHub Actions

- —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ –≤ GHCR

- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

- –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ develop –∏ main –≤–µ—Ç–æ–∫

- –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä—É—á–Ω—ã—Ö —à–∞–≥–æ–≤

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∞, –Ω–∞–¥—ë–∂–Ω–∞ –∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è staging-–æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ zero-downtime –¥–µ–ø–ª–æ—è).