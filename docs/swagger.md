# Swagger / OpenAPI Documentation — Atomic Habits Tracker

В проекте Atomic Habits Tracker используется автоматическая генерация документации API на основе OpenAPI схемы.  
Это позволяет:

- получать всегда актуальную документацию
- использовать Swagger UI для тестирования API
- использовать Redoc для красивого отображения
- генерировать клиентов для frontend и Telegram-бота

---

## 1. Используемый инструмент

В проекте используется:

| Инструмент | Назначение |
|------------|------------|
| drf-spectacular | Генерация OpenAPI 3.0 схемы |
| Swagger UI | Интерактивная документация |
| Redoc | Читаемая HTML-документация |
| OpenAPI | Стандарт описания API |

---

## 2. Установка и подключение

Зависимость подключена в backend:

drf-spectacular

Добавлена в `INSTALLED_APPS`:

- drf_spectacular

В `REST_FRAMEWORK` используется схема:

- DEFAULT_SCHEMA_CLASS = drf_spectacular.openapi.AutoSchema

---

## 3. Генерация OpenAPI схемы

OpenAPI-схема генерируется автоматически на основе:

- DRF сериализаторов
- DRF viewset’ов
- APIView
- описаний через extend_schema
- типов данных
- ответов и кодов ошибок

Основной файл схемы доступен по адресу:

/api/schema/

Формат:

- JSON (по умолчанию)
- YAML (по необходимости)

---

## 4. Swagger UI

Swagger UI используется для интерактивного тестирования API.

Адрес:

/api/docs/

Возможности Swagger UI:

- просмотр всех эндпоинтов
- просмотр параметров
- просмотр JSON-схем
- тестирование запросов прямо из браузера
- подстановка JWT-токена

---

## 5. Redoc

Redoc используется для красивого и читабельного отображения API.

Адрес:

/api/redoc/

Используется для:

- быстрого изучения API
- онбординга разработчиков
- публичной документации

---

## 6. Авторизация в Swagger

Для авторизации используется JWT.

Процедура:

1. Выполнить POST `/auth/login/`
2. Скопировать access-токен
3. Нажать кнопку Authorize в Swagger UI
4. Вставить:

`Bearer <access_token>`


После этого все приватные эндпоинты становятся доступны.

---

## 7. Версионирование схемы

Текущая версия OpenAPI:

- v1

Схема генерируется из актуального кода backend без ручного редактирования.

При изменении API:

- схема обновляется автоматически
- Swagger и Redoc начинают показывать новые эндпоинты

---

## 8. Использование схемы для frontend

Frontend использует:

- ручную реализацию API-клиентов (axios)
- типизация опирается на OpenAPI-логику

В будущем возможно:

- автоматическое генерирование TypeScript API-клиента
- автогенерация типов данных

---

## 9. Использование схемы для Telegram-бота

Telegram-бот использует:

- те же эндпоинты
- те же схемы
- ту же систему авторизации

Это гарантирует:

- единый контракт API
- отсутствие рассинхронизации между frontend и ботом

---

## 10. Безопасность

OpenAPI схема:

- не содержит чувствительных данных
- не отображает реальные секреты
- описывает только структуру запросов и ответов

Доступ к Swagger и Redoc:

- может быть ограничен в production
- может быть защищён basic auth или IP whitelist

---

## 11. Итог

Swagger и OpenAPI в проекте Atomic Habits Tracker обеспечивают:

- автоматическую актуализацию документации
- быстрый доступ к API для разработчиков
- удобное тестирование эндпоинтов
- единый источник правды для frontend, backend и Telegram-бота
- основу для масштабирования и публичного API в будущем
